import{T as it}from"./TopBar-TE3OBIJW.js";import{_ as dt,u as rt,b as pt,i as L,e as E,r as _,f as ct,j as l,o as a,c,a as t,k as o,m as d,w as s,l as r,n as O,q as h,F as N,p as A,s as ut,v as _t}from"./index-78te5h-u.js";import{A as ft,C as ht}from"./Close-c0HtZweH.js";const w=k=>(ut("data-v-3e19dc8f"),k=k(),_t(),k),vt={style:{position:"fixed",top:"0",height:"50px",width:"100%","z-index":"999"}},mt={class:"card"},xt={style:{position:"absolute",left:"40px",bottom:"20px"}},yt={style:{position:"absolute",top:"25px",left:"200px","font-size":"20px"}},gt={style:{position:"absolute",top:"70px",left:"200px"}},bt={style:{"font-weight":"bold","font-size":"20px"}},wt=w(()=>t("text",{style:{"margin-left":"5px","font-size":"14px"}},"文章",-1)),kt={style:{"font-weight":"bold","font-size":"20px","margin-left":"20px"}},Ct=w(()=>t("text",{style:{"margin-left":"5px","font-size":"14px"}},"粉丝",-1)),zt={style:{width:"600px",height:"320px",background:"white"}},Mt={key:0,style:{width:"300px",height:"150px",margin:"0 auto"}},Ut={style:{"margin-bottom":"12px"}},Tt={key:1,style:{width:"230px",margin:"0 auto"}},qt={style:{position:"absolute",right:"90px",bottom:"20px"}},It={style:{position:"absolute",right:"20px",bottom:"20px"}},St={style:{width:"440px",height:"185px",background:"white"}},Bt={style:{width:"350px"}},Lt={style:{position:"absolute",right:"90px",bottom:"20px"}},Nt={style:{position:"absolute",right:"20px",bottom:"20px"}},At={class:"tabs"},Dt={style:{"margin-bottom":"15px"}},Ht={style:{position:"absolute",left:"240px",width:"690px"}},$t={style:{"font-weight":"bold","font-size":"20px"}},Ft=["innerHTML"],Rt=w(()=>t("div",{style:{"text-align":"center"}},[r(" 文章太精彩了"),t("br"),r("点进去看看吧 ")],-1)),Vt={style:{position:"absolute","margin-top":"10px"}},jt={style:{height:"140px"}},Et={style:{"font-weight":"bold","font-size":"20px"}},Ot=["innerHTML"],Gt=w(()=>t("div",{style:{"text-align":"center"}},[r(" 文章太精彩了"),t("br"),r("点进去看看吧 ")],-1)),Jt={style:{position:"absolute","margin-top":"10px"}},Kt={style:{"margin-bottom":"15px"}},Pt={style:{position:"absolute",left:"240px",width:"690px"}},Qt={style:{"font-weight":"bold","font-size":"20px"}},Wt=["innerHTML"],Xt=w(()=>t("div",{style:{"text-align":"center"}},[r(" 文章太精彩了"),t("br"),r("点进去看看吧 ")],-1)),Yt={style:{position:"absolute","margin-top":"10px"}},Zt={style:{height:"140px"}},te=["onClick"],ee=["onClick"],oe={style:{position:"absolute","margin-top":"10px"}},se={style:{"margin-bottom":"15px"}},ne={style:{position:"absolute",left:"90px",top:"25px","font-size":"20px"}},ae={__name:"Myself",setup(k){const D=rt(),T=pt();L("serverUrl");const C=L("axios"),v=L("message"),G=E([{label:"修改头像",key:"avatar"},{label:"修改用户名",key:"name"}]),p=E({self:!1,avatarUrl:"",name:"",number:0,fans:0,id:0}),z=_(""),M=_(!1),U=_(""),m=_(!1),x=_(!1),H=_([]),$=_([]),F=_([]);ct(()=>{q()});const q=async()=>{let e=await C.get("user/detailedInfo/"+T.query.id);console.log(e),e.code==200&&(p.self=e.data.self,p.avatarUrl=e.data.avatar,p.name=e.data.username,p.number=e.data.articles.length,p.fans=e.data.fans,p.id=e.data.id,H.value=e.data.articles,$.value=e.data.collects,F.value=e.data.following,U.value=p.name)},J=e=>{String(e)=="avatar"&&(m.value=!0),String(e)=="name"&&(x.value=!0)},K=()=>{z.value="",M.value=!1},P=async e=>{var i;return((i=e.file.file)==null?void 0:i.type)!=="image/png"?(v.error("只能上传png格式的图片"),!1):!0},Q=async({file:e})=>{const i=new FormData;i.append("file",e.file),i.append("type","avatar");let g=await C.post("/upload",i);console.log(g),z.value=g.data,M.value=!0},W=async()=>{let e=await C.put("user/avatar/"+T.query.id,{avatar:z.value});console.log(e),e.code==200?(v.success(e.message),m.value=!1,q()):v.error(e.message)},X=async()=>{let e=await C.put("user/name/"+T.query.id,{username:U.value});console.log(e),e.code==200?(v.success(e.message),x.value=!1,q()):v.error(e.message)},Y=()=>{m.value=!1},Z=()=>{x.value=!1},tt=e=>{D.push({path:"/others",query:{id:e.userid}})},y=e=>{D.push({path:"/detail",query:{id:e.articleid}})};return(e,i)=>{const g=l("n-avatar"),f=l("n-button"),et=l("n-dropdown"),R=l("n-icon"),ot=l("n-text"),st=l("n-upload-dragger"),nt=l("n-upload"),I=l("n-image"),u=l("n-card"),V=l("n-modal"),at=l("n-input"),S=l("n-ellipsis"),B=l("n-tab-pane"),lt=l("n-tabs");return a(),c("div",null,[t("div",vt,[o(it)]),t("div",mt,[t("div",xt,[o(g,{round:"",size:120,src:p.avatarUrl,bordered:!0},null,8,["src"])]),t("div",yt,d(p.name),1),t("div",gt,[t("text",bt,d(p.number),1),wt,t("text",kt,d(p.fans),1),Ct]),o(et,{trigger:"hover",options:G,onSelect:J},{default:s(()=>[o(f,{style:{position:"absolute",right:"40px",top:"25px"},round:"",ghost:"",color:"#7B3DE0"},{default:s(()=>[r("修改资料")]),_:1})]),_:1},8,["options"])]),o(V,{show:m.value,"onUpdate:show":i[0]||(i[0]=n=>m.value=n)},{default:s(()=>[t("div",zt,[o(u,{title:"修改头像",bordered:!1},{default:s(()=>[M.value?(a(),c("div",Tt,[o(I,{height:"150",width:"300",src:z.value},null,8,["src"]),o(f,{onClick:K,circle:"",style:{position:"absolute",left:"298px",top:"50px"},color:"#383838"},{icon:s(()=>[o(R,null,{default:s(()=>[o(O(ht))]),_:1})]),_:1})])):(a(),c("div",Mt,[o(nt,{multiple:"","directory-dnd":"",max:1,onBeforeUpload:P,"custom-request":Q},{default:s(()=>[o(st,null,{default:s(()=>[t("div",Ut,[o(R,{size:"48",depth:3},{default:s(()=>[o(O(ft))]),_:1})]),o(ot,{style:{"font-size":"16px"}},{default:s(()=>[r(" 点击或者拖动图片到此处 ")]),_:1})]),_:1})]),_:1})]))]),_:1}),t("div",qt,[o(f,{type:"default",onClick:Y},{default:s(()=>[r(" 取消 ")]),_:1})]),t("div",It,[M.value?(a(),h(f,{key:0,onClick:W,type:"primary"},{default:s(()=>[r(" 确认 ")]),_:1})):(a(),h(f,{key:1,type:"primary",disabled:""},{default:s(()=>[r(" 确认 ")]),_:1}))])])]),_:1},8,["show"]),o(V,{show:x.value,"onUpdate:show":i[2]||(i[2]=n=>x.value=n)},{default:s(()=>[t("div",St,[o(u,{title:"修改用户名",bordered:!1},{default:s(()=>[t("div",Bt,[o(at,{value:U.value,"onUpdate:value":i[1]||(i[1]=n=>U.value=n),size:"large",round:"",type:"text",placeholder:"请输入用户名"},null,8,["value"])])]),_:1}),t("div",Lt,[o(f,{type:"default",onClick:Z},{default:s(()=>[r(" 取消 ")]),_:1})]),t("div",Nt,[o(f,{type:"primary",onClick:X},{default:s(()=>[r(" 确认 ")]),_:1})])])]),_:1},8,["show"]),t("div",At,[o(u,null,{default:s(()=>[o(lt,{type:"line"},{default:s(()=>[o(B,{name:"articles",tab:"我的文章"},{default:s(()=>[(a(!0),c(N,null,A(H.value,(n,j)=>(a(),c("div",Dt,[n.avatar?(a(),h(u,{key:0,onClick:b=>y(n),style:{cursor:"pointer"},hoverable:""},{default:s(()=>[o(I,{height:"135",width:"200",src:n.avatar,style:{float:"left"}},null,8,["src"]),t("div",Ht,[t("text",$t,d(n.title),1),t("p",null,[o(S,{"line-clamp":2},{tooltip:s(()=>[Rt]),default:s(()=>[t("p",{innerHTML:n.content},null,8,Ft)]),_:2},1024)]),t("div",Vt,"发布时间："+d(n.releasetime),1)])]),_:2},1032,["onClick"])):(a(),h(u,{key:1,onClick:b=>y(n),style:{cursor:"pointer"},hoverable:""},{default:s(()=>[t("div",jt,[t("text",Et,d(n.title),1),t("p",null,[o(S,{"line-clamp":2},{tooltip:s(()=>[Gt]),default:s(()=>[t("p",{innerHTML:n.content},null,8,Ot)]),_:2},1024)]),t("div",Jt,"发布时间："+d(n.releasetime),1)])]),_:2},1032,["onClick"]))]))),256))]),_:1}),o(B,{name:"collects",tab:"我的收藏"},{default:s(()=>[(a(!0),c(N,null,A($.value,(n,j)=>(a(),c("div",Kt,[n.avatar?(a(),h(u,{key:0,onClick:b=>y(n),style:{cursor:"pointer"},hoverable:""},{default:s(()=>[o(I,{height:"135",width:"200",src:n.avatar,style:{float:"left"}},null,8,["src"]),t("div",Pt,[t("text",Qt,d(n.title),1),t("p",null,[o(S,{"line-clamp":1},{tooltip:s(()=>[Xt]),default:s(()=>[t("p",{innerHTML:n.content},null,8,Wt)]),_:2},1024)]),t("div",Yt,"发布时间："+d(n.releasetime),1)])]),_:2},1032,["onClick"])):(a(),h(u,{key:1,style:{cursor:"pointer"},hoverable:""},{default:s(()=>[t("div",Zt,[t("text",{onClick:b=>y(n),style:{"font-weight":"bold","font-size":"20px"}},d(n.title),9,te),t("p",{onClick:b=>y(n)},d(n.content+"..."),9,ee),t("div",oe,"发布时间："+d(n.releasetime),1)])]),_:2},1024))]))),256))]),_:1}),o(B,{name:"following",tab:"我的关注"},{default:s(()=>[(a(!0),c(N,null,A(F.value,(n,j)=>(a(),c("div",se,[o(u,null,{default:s(()=>[o(g,{onClick:b=>tt(n),round:"",size:"large",src:n.avatar,style:{float:"left",cursor:"pointer"}},null,8,["onClick","src"]),t("text",ne,d(n.username),1)]),_:2},1024)]))),256))]),_:1})]),_:1})]),_:1})])])}}},re=dt(ae,[["__scopeId","data-v-3e19dc8f"]]);export{re as default};
